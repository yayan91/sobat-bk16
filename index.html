<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOBAT-BK16 | Ultimate</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* Base Setup (Dark Default) */
        body {
            background-color: #0f0f0f;
            color: #ffffff;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            overflow-x: hidden;
            background-image: radial-gradient(circle at 50% 0%, #2a2a2a 0%, #0f0f0f 70%);
            transition: background 0.5s ease, color 0.5s ease;
        }

        /* LIGHT MODE OVERRIDES */
        body.light-mode {
            background-color: #f3f4f6;
            background-image: radial-gradient(circle at 50% 0%, #ffffff 0%, #f3f4f6 80%);
            color: #1f2937;
        }
        
        body.light-mode .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        body.light-mode .card-3d {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            color: #1f2937;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        body.light-mode .card-3d h3 { color: #111827; }
        body.light-mode .card-3d p { color: #6b7280; }
        
        /* Text Color Overrides for Light Mode */
        body.light-mode .text-white { color: #111827 !important; }
        body.light-mode .text-gray-300 { color: #4b5563 !important; }
        body.light-mode .text-gray-400 { color: #6b7280 !important; }
        body.light-mode .text-gray-500 { color: #9ca3af !important; }

        /* Form Elements Light Mode */
        body.light-mode input, 
        body.light-mode select, 
        body.light-mode textarea {
            background-color: #ffffff !important;
            border-color: #d1d5db !important;
            color: #111827 !important;
        }

        /* Modal Inner Elements Light Mode */
        body.light-mode .bg-\[\#1a1a1a\] { background-color: #ffffff !important; border: 1px solid #e5e7eb; }
        body.light-mode .bg-\[\#111\] { background-color: #f9fafb !important; border-bottom: 1px solid #e5e7eb; }
        body.light-mode .border-gray-800 { border-color: #e5e7eb !important; }
        
        /* Navbar Light Mode */
        body.light-mode nav {
            background: rgba(255,255,255,0.9);
            border-bottom: 1px solid #e5e7eb;
        }
        body.light-mode .btn-back {
            background: #e5e7eb;
            color: #374151;
            border: 1px solid #d1d5db;
        }
        
        /* Footer Light Mode */
        body.light-mode footer {
            background: #ffffff;
            border-top: 1px solid #e5e7eb;
        }

        /* Hide Scrollbar */
        .hide-scroll::-webkit-scrollbar { display: none; }
        .hide-scroll { -ms-overflow-style: none; scrollbar-width: none; }

        /* 3D Card Effect */
        .perspective-container {
            perspective: 1000px;
        }

        .card-3d {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.5);
        }

        .card-3d:hover {
            transform: translateY(-5px) rotateX(2deg);
            box-shadow: 0 20px 40px -5px rgba(229, 9, 20, 0.3);
            border-color: #E50914;
        }

        /* Glassmorphism for Modals */
        .glass-panel {
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transition: background 0.3s ease;
        }

        /* Animasi Masuk */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-up { animation: fadeUp 0.6s ease forwards; }
        
        /* Logo Glow Animation */
        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 5px rgba(229, 9, 20, 0.5)); }
            50% { filter: drop-shadow(0 0 20px rgba(229, 9, 20, 0.8)); }
        }
        .logo-glow { animation: glow 3s infinite; }

        /* Tombol Kembali Keren */
        .btn-back {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }
        .btn-back:hover {
            background: #E50914;
            border-color: #E50914;
            transform: scale(1.05);
            color: white !important;
        }

        /* Custom Alert Animation */
        @keyframes popIn {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-pop { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }

        /* --- MAGIC FAB STYLES --- */
        .fab-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
        }
        .fab-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #E50914, #b2070f);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            box-shadow: 0 10px 25px rgba(229, 9, 20, 0.5);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        .fab-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }
        .fab-menu {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 15px;
            pointer-events: none;
        }
        .fab-item {
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(20px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        .fab-menu.active {
            pointer-events: auto;
        }
        .fab-menu.active .fab-item {
            transform: translateX(0);
            opacity: 1;
        }
        .fab-icon-small {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: #222;
            border: 1px solid #333;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: 0.2s;
        }
        .fab-icon-small:hover {
            background: #E50914;
            border-color: #E50914;
        }
        .fab-label {
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-[#0f0f0f] min-h-screen flex flex-col">

    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="fixed inset-0 z-[100] flex items-center justify-center bg-black">
        <div class="absolute inset-0 bg-[url('https://assets.nflxext.com/ffe/siteui/vlv3/f841d4c7-10e1-40af-bcae-07a3f8dc141a/f6d7434e-d6de-4185-a6d4-c77a2d08648f/ID-en-20220502-popsignuptwoweeks-perspective_alpha_website_medium.jpg')] bg-cover opacity-40 grayscale"></div>
        <div class="relative z-10 glass-panel p-10 rounded-2xl max-w-md w-full border-t border-red-900 shadow-2xl animate-up">
            <div class="flex justify-center mb-6">
                <img src="https://drive.google.com/thumbnail?id=1Z6g-sCdw-k7W8dnw12NeagPkroLlmk-L" alt="Logo Sekolah" class="w-24 h-24 object-contain logo-glow">
            </div>
            <h1 class="text-4xl font-bold mb-2 text-white tracking-tighter text-center drop-shadow-md">SOBAT-BK16</h1>
            <p class="text-center text-gray-400 text-sm mb-8">Sistem Online BK & Administrasi Terpadu</p>
            <form onsubmit="handleLogin(event)" class="space-y-5">
                <div class="relative group">
                    <i class="fas fa-user absolute left-4 top-4 text-gray-400 group-focus-within:text-red-500 transition"></i>
                    <input type="text" id="username" placeholder="Username Guru" class="w-full pl-12 p-4 rounded-lg bg-[#222] text-white border border-gray-700 focus:border-red-500 focus:ring-1 focus:ring-red-500 focus:outline-none transition" required>
                </div>
                <div class="relative group">
                    <i class="fas fa-lock absolute left-4 top-4 text-gray-400 group-focus-within:text-red-500 transition"></i>
                    <input type="password" id="password" placeholder="Kata Sandi" class="w-full pl-12 p-4 rounded-lg bg-[#222] text-white border border-gray-700 focus:border-red-500 focus:ring-1 focus:ring-red-500 focus:outline-none transition" required>
                </div>
                <button type="submit" id="btn-login" class="w-full bg-gradient-to-r from-[#E50914] to-[#b2070f] hover:from-[#ff1f2b] hover:to-[#d60a15] text-white font-bold py-4 rounded-lg shadow-lg transform active:scale-95 transition flex justify-center items-center gap-2">
                    MASUK APLIKASI <i class="fas fa-arrow-right"></i>
                </button>
            </form>
            <p class="mt-6 text-center text-xs text-gray-500">&copy; 2026 - UPT SPF SMP NEGERI 16 MAKASSAR</p>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="main-app" class="hidden relative flex-grow">
        
        <!-- Navbar -->
        <nav class="flex justify-between items-center px-6 py-4 sticky top-0 z-40 bg-gradient-to-b from-black/90 to-transparent backdrop-blur-sm transition-colors duration-300">
            <div class="flex items-center gap-3">
                <img src="https://drive.google.com/thumbnail?id=1Z6g-sCdw-k7W8dnw12NeagPkroLlmk-L" class="w-8 h-8 opacity-80">
                <div>
                    <h1 class="text-xl font-bold text-[#E50914] tracking-tighter leading-none">SOBAT-BK16</h1>
                    <p class="text-[10px] text-gray-400 tracking-widest uppercase">UPT SPF SMP NEGERI 16 MAKASSAR</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="toggleTheme()" id="theme-btn" class="text-gray-400 hover:text-yellow-400 transition transform hover:rotate-12 p-2" title="Ganti Tema">
                    <i class="fas fa-sun text-lg"></i>
                </button>
                <div class="h-4 w-px bg-gray-600"></div>
                <button onclick="confirmLogout()" class="text-gray-400 hover:text-[#E50914] text-sm flex items-center gap-2 px-3 py-1 rounded hover:bg-white/10 transition">
                    <i class="fas fa-sign-out-alt"></i> Keluar
                </button>
            </div>
        </nav>

        <!-- DASHBOARD CONTENT -->
        <div class="container mx-auto px-4 pt-4 perspective-container mb-20">
            
            <!-- Welcome Text -->
            <div class="text-center mb-8 animate-up">
                <h2 class="text-3xl md:text-5xl font-bold mb-2">Halo, <span id="dash-nama" class="text-[#E50914]">Guru Hebat</span></h2>
                <p class="text-gray-300 text-sm md:text-lg">Sistem Online BK & Administrasi Terpadu</p>
            </div>

            <!-- WIDGET BAR (CLOCK & STATS) -->
            <div class="flex flex-col md:flex-row gap-4 justify-between items-stretch mb-10 animate-up" style="animation-delay: 0.1s;">
                <!-- Clock Widget -->
                <div class="glass-panel p-4 rounded-xl flex items-center gap-4 w-full md:w-auto flex-1 border border-gray-700">
                    <div class="bg-red-600/20 p-3 rounded-lg text-[#E50914]">
                        <i class="far fa-clock text-2xl"></i>
                    </div>
                    <div>
                        <h3 id="widget-time" class="text-3xl font-bold font-mono leading-none text-white tracking-widest">--:--</h3>
                        <p id="widget-date" class="text-xs text-gray-400 uppercase tracking-wide">Memuat Waktu...</p>
                    </div>
                </div>

                <!-- Stats Widget -->
                <div class="flex gap-4 w-full md:w-auto overflow-x-auto">
                    <div class="glass-panel p-4 rounded-xl flex items-center gap-3 flex-1 min-w-[160px] border border-gray-700">
                        <div class="bg-green-600/20 p-2 rounded-lg text-green-500">
                            <i class="fas fa-users text-2xl"></i>
                        </div>
                        <div>
                            <p class="text-[10px] text-gray-400 uppercase font-bold">Total Siswa</p>
                            <h4 id="stat-total-siswa" class="text-2xl font-bold text-white">0</h4>
                        </div>
                    </div>
                    <div class="glass-panel p-4 rounded-xl flex items-center gap-3 flex-1 min-w-[160px] border border-gray-700">
                        <div class="bg-purple-600/20 p-2 rounded-lg text-purple-500">
                            <i class="fas fa-folder text-2xl"></i>
                        </div>
                        <div>
                            <p class="text-[10px] text-gray-400 uppercase font-bold">Total Media/RPLBK</p>
                            <h4 id="stat-total-media" class="text-2xl font-bold text-white">0</h4>
                        </div>
                    </div>
                </div>
            </div>

            <!-- NEW: QUOTE WIDGET -->
            <div class="mb-10 animate-up text-center px-4" style="animation-delay: 0.15s;">
                <div class="glass-panel p-4 rounded-full border border-gray-800 inline-block max-w-3xl">
                    <p class="text-gray-400 italic text-sm"><i class="fas fa-quote-left text-[#E50914] mr-2"></i> <span id="daily-quote">Pendidikan adalah senjata paling mematikan di dunia.</span> <i class="fas fa-quote-right text-[#E50914] ml-2"></i></p>
                </div>
            </div>

            <!-- Grid 4 Menu Utama -->
            <div class="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-8 max-w-6xl mx-auto">
                
                <!-- 1. MENU PROFIL -->
                <div onclick="openProfileModal()" class="card-3d bg-[#1f1f1f] rounded-2xl p-4 md:p-6 border border-gray-800 cursor-pointer relative group overflow-hidden h-60 md:h-72 flex flex-col justify-between">
                    <div class="absolute top-0 right-0 p-4 opacity-30 group-hover:opacity-100 transition duration-500">
                        <i class="fas fa-id-card text-3xl md:text-5xl text-gray-500 group-hover:text-[#E50914]"></i>
                    </div>
                    <div>
                        <div class="w-14 h-14 md:w-20 md:h-20 rounded-full overflow-hidden border-4 border-[#E50914] mb-4 shadow-lg group-hover:scale-110 transition">
                            <img id="menu-foto" src="" class="w-full h-full object-cover">
                        </div>
                        <h3 class="text-lg md:text-2xl font-bold text-white leading-tight">Profil Guru</h3>
                        <p class="text-xs md:text-sm text-gray-400">Data Diri</p>
                    </div>
                    <div class="mt-2 md:mt-4 flex items-center text-[10px] md:text-sm text-[#E50914] font-bold tracking-wider">
                        BUKA PROFIL <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition"></i>
                    </div>
                </div>

                <!-- 2. MENU APLIKASI -->
                <div onclick="openAppModal()" class="card-3d bg-[#1f1f1f] rounded-2xl p-4 md:p-6 border border-gray-800 cursor-pointer relative group overflow-hidden h-60 md:h-72 flex flex-col justify-between">
                    <div class="absolute -right-4 -bottom-4 md:-right-6 md:-bottom-6 opacity-10 group-hover:opacity-30 transition transform group-hover:scale-110 duration-500">
                        <i class="fas fa-cubes text-7xl md:text-9xl text-blue-600"></i>
                    </div>
                    <div>
                        <div class="w-10 h-10 md:w-14 md:h-14 bg-blue-900/30 rounded-xl flex items-center justify-center mb-4 text-blue-500 shadow-[0_0_15px_rgba(59,130,246,0.5)]">
                            <i class="fas fa-th-large text-lg md:text-2xl"></i>
                        </div>
                        <h3 class="text-lg md:text-2xl font-bold text-white leading-tight">Aplikasi BK</h3>
                        <p class="text-xs md:text-sm text-gray-400">Daftar Aplikasi & Instrumen BK</p>
                    </div>
                    <div class="mt-2 md:mt-4 flex items-center text-[10px] md:text-sm text-blue-500 font-bold tracking-wider">
                        AKSES FOLDER <i class="fas fa-folder-open ml-2 group-hover:translate-x-2 transition"></i>
                    </div>
                </div>

                <!-- 3. MENU DATA SISWA -->
                <div onclick="openSiswaModal()" class="card-3d bg-[#1f1f1f] rounded-2xl p-4 md:p-6 border border-gray-800 cursor-pointer relative group overflow-hidden h-60 md:h-72 flex flex-col justify-between">
                    <div class="absolute -right-4 -bottom-4 md:-right-6 md:-bottom-6 opacity-10 group-hover:opacity-30 transition transform group-hover:scale-110 duration-500">
                        <i class="fas fa-users text-7xl md:text-9xl text-green-600"></i>
                    </div>
                    <div>
                        <div class="w-10 h-10 md:w-14 md:h-14 bg-green-900/30 rounded-xl flex items-center justify-center mb-4 text-green-500 shadow-[0_0_15px_rgba(34,197,94,0.5)]">
                            <i class="fas fa-user-graduate text-lg md:text-2xl"></i>
                        </div>
                        <h3 class="text-lg md:text-2xl font-bold text-white leading-tight">Data Siswa</h3>
                        <p class="text-xs md:text-sm text-gray-400">Database Siswa</p>
                    </div>
                    <div class="mt-2 md:mt-4 flex items-center text-[10px] md:text-sm text-green-500 font-bold tracking-wider">
                        CARI DATA <i class="fas fa-search ml-2 group-hover:translate-x-2 transition"></i>
                    </div>
                </div>

                <!-- 4. MENU MEDIA -->
                <div onclick="openMediaListModal()" class="card-3d bg-[#1f1f1f] rounded-2xl p-4 md:p-6 border border-gray-800 cursor-pointer relative group overflow-hidden h-60 md:h-72 flex flex-col justify-between">
                    <div class="absolute -right-4 -bottom-4 md:-right-6 md:-bottom-6 opacity-10 group-hover:opacity-30 transition transform group-hover:scale-110 duration-500">
                        <i class="fas fa-file-alt text-7xl md:text-9xl text-purple-600"></i>
                    </div>
                    <div>
                        <div class="w-10 h-10 md:w-14 md:h-14 bg-purple-900/30 rounded-xl flex items-center justify-center mb-4 text-purple-500 shadow-[0_0_15px_rgba(168,85,247,0.5)]">
                            <i class="fas fa-cloud-upload-alt text-lg md:text-2xl"></i>
                        </div>
                        <h3 class="text-lg md:text-2xl font-bold text-white leading-tight">Media & RPLBK</h3>
                        <p class="text-xs md:text-sm text-gray-400">Arsip Digital Media & RPLBK</p>
                    </div>
                    <div class="mt-2 md:mt-4 flex items-center text-[10px] md:text-sm text-purple-500 font-bold tracking-wider">
                        KELOLA FILE <i class="fas fa-list ml-2 group-hover:translate-x-2 transition"></i>
                    </div>
                </div>

            </div>

            <!-- VIDEO SECTION -->
            <div class="mt-20 px-4 md:px-12 animate-up" style="animation-delay: 0.3s;">
                <h3 class="text-xl font-semibold mb-4 border-l-4 border-[#E50914] pl-3 text-white">Video Pembelajaran Terbaru</h3>
                <div class="flex overflow-x-auto gap-4 pb-8 hide-scroll" id="video-container">
                    <!-- Video Items rendered here -->
                </div>
            </div>
        </div>

        <!-- FOOTER (NEW) -->
        <footer class="mt-auto border-t border-gray-800 bg-[#0a0a0a] pt-12 pb-8">
            <div class="container mx-auto px-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8 text-sm">
                    <div class="col-span-1 md:col-span-2">
                        <h3 class="text-2xl font-bold text-[#E50914] mb-4 tracking-tighter">SOBAT-BK16</h3>
                        <p class="text-gray-400 max-w-md leading-relaxed">
                            Sistem Administrasi Terpadu Bimbingan Konseling yang didesain untuk memudahkan pengelolaan data siswa, media pembelajaran, dan layanan BK dalam satu pintu digital yang modern.
                        </p>
                    </div>
                    <div>
                        <h4 class="font-bold text-white mb-4 uppercase tracking-wider">Akses Cepat</h4>
                        <ul class="space-y-3 text-gray-400">
                            <li><a href="#" onclick="openProfileModal()" class="hover:text-[#E50914] transition">Profil Guru</a></li>
                            <li><a href="#" onclick="openAppModal()" class="hover:text-[#E50914] transition">Aplikasi & Instrumen</a></li>
                            <li><a href="#" onclick="openSiswaModal()" class="hover:text-[#E50914] transition">Database Siswa</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold text-white mb-4 uppercase tracking-wider">Bantuan</h4>
                        <ul class="space-y-3 text-gray-400">
                            <li><a href="#" class="hover:text-[#E50914] transition">Panduan Penggunaan</a></li>
                            <li><a href="https://wa.me/6285111032102" class="hover:text-[#E50914] transition" target="_blank">Laporkan Kendala
                            <li><a href="#" onclick="confirmLogout()" class="hover:text-[#E50914] transition">Keluar Aplikasi</a></li>
                        </ul>
                    </div>
                </div>
                <div class="border-t border-gray-800 pt-8 flex flex-col md:flex-row justify-between items-center text-xs text-gray-500">
                    <p>&copy; 2026 - Mappaguru Online.</p>
                    <div class="flex gap-6 mt-4 md:mt-0 text-lg">
                        <a href="#" class="hover:text-white transition"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="hover:text-white transition"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="hover:text-white transition"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
        </footer>

    </div>

    <!-- ===== MAGIC FAB (FLOATING BUTTON) ===== -->
    <div class="fab-container">
        <div class="fab-menu" id="fab-menu">
            <!-- Item 1: Stopwatch -->
            <div class="fab-item">
                <div class="fab-label">Stopwatch</div>
                <div onclick="openStopwatchModal()" class="fab-icon-small hover:bg-yellow-600 hover:border-yellow-600">
                    <i class="fas fa-stopwatch"></i>
                </div>
            </div>
            <!-- Item 2: Export Data -->
            <div class="fab-item" style="transition-delay: 0.05s;">
                <div class="fab-label">Export Siswa (Excel)</div>
                <div onclick="exportSiswaToCSV()" class="fab-icon-small hover:bg-green-600 hover:border-green-600">
                    <i class="fas fa-file-excel"></i>
                </div>
            </div>
            <!-- Item 3: Notes -->
            <div class="fab-item" style="transition-delay: 0.1s;">
                <div class="fab-label">Catatan Pribadi</div>
                <div onclick="openNoteModal()" class="fab-icon-small hover:bg-blue-600 hover:border-blue-600">
                    <i class="fas fa-sticky-note"></i>
                </div>
            </div>
        </div>
        <div onclick="toggleFab()" class="fab-btn">
            <i class="fas fa-plus transition-transform duration-300" id="fab-icon-main"></i>
        </div>
    </div>

    <!-- ================= MODALS & ALERTS ================= -->

    <!-- CUSTOM ALERT -->
    <div id="custom-alert-modal" class="fixed inset-0 z-[120] bg-black/90 hidden flex items-center justify-center p-4 backdrop-blur-sm transition-opacity duration-300">
        <div class="glass-panel max-w-sm w-full p-6 rounded-2xl border border-gray-700 shadow-2xl animate-pop text-center">
            <div id="alert-icon-bg" class="mx-auto flex items-center justify-center h-16 w-16 rounded-full mb-4 shadow-lg">
                <i id="alert-icon" class="text-3xl text-white"></i>
            </div>
            <h3 id="alert-title" class="text-xl font-bold text-white mb-2 tracking-tight">Judul Notifikasi</h3>
            <p id="alert-message" class="text-gray-300 text-sm mb-6 leading-relaxed">Pesan notifikasi.</p>
            <div id="alert-buttons" class="flex gap-3 justify-center"></div>
        </div>
    </div>

    <!-- STOPWATCH MODAL (LOCAL TOOL) -->
    <div id="stopwatch-modal" class="fixed inset-0 z-[110] bg-black/90 hidden flex items-center justify-center p-4 backdrop-blur-md">
        <div class="glass-panel w-full max-w-sm rounded-2xl p-8 border border-gray-700 shadow-2xl text-center">
            <h3 class="text-xl font-bold text-yellow-500 mb-6 uppercase tracking-widest">Timer Konseling</h3>
            <div class="text-6xl font-mono text-white mb-8" id="sw-display">00:00:00</div>
            <div class="flex justify-center gap-4">
                <button onclick="startStopwatch()" id="sw-start" class="bg-green-600 hover:bg-green-700 text-white w-12 h-12 rounded-full flex items-center justify-center"><i class="fas fa-play"></i></button>
                <button onclick="pauseStopwatch()" class="bg-yellow-600 hover:bg-yellow-700 text-white w-12 h-12 rounded-full flex items-center justify-center"><i class="fas fa-pause"></i></button>
                <button onclick="resetStopwatch()" class="bg-red-600 hover:bg-red-700 text-white w-12 h-12 rounded-full flex items-center justify-center"><i class="fas fa-undo"></i></button>
            </div>
            <button onclick="closeModal('stopwatch-modal')" class="mt-8 text-gray-400 text-sm hover:text-white">Tutup Timer</button>
        </div>
    </div>

    <!-- STICKY NOTES MODAL (LOCAL STORAGE) -->
    <div id="note-modal" class="fixed inset-0 z-[110] bg-black/90 hidden flex items-center justify-center p-4 backdrop-blur-md">
        <div class="glass-panel w-full max-w-lg rounded-2xl p-6 border border-gray-700 shadow-2xl">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-blue-400"><i class="fas fa-sticky-note mr-2"></i> Catatan Harian</h3>
                <button onclick="closeModal('note-modal')" class="text-gray-400 hover:text-white"><i class="fas fa-times"></i></button>
            </div>
            <textarea id="my-notes" class="w-full h-64 bg-[#222] text-white p-4 rounded-lg border border-gray-600 focus:border-blue-500 outline-none resize-none mb-4 font-mono text-sm" placeholder="Tulis catatan penting disini... (Tersimpan otomatis)"></textarea>
            <div class="flex justify-between items-center text-xs text-gray-500">
                <span>*Disimpan di browser perangkat ini</span>
                <button onclick="saveNotes()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded font-bold">Simpan</button>
            </div>
        </div>
    </div>

    <!-- 1. MODAL PROFIL -->
    <div id="profile-modal" class="fixed inset-0 z-[60] bg-black/90 hidden flex items-center justify-center p-4 backdrop-blur-md">
        <div class="glass-panel w-full max-w-2xl rounded-2xl overflow-hidden shadow-2xl relative flex flex-col md:flex-row min-h-[450px]">
            <div class="w-full md:w-1/3 bg-[#111] p-6 flex flex-col items-center justify-center text-center border-r border-gray-800 relative">
                <div class="w-32 h-32 rounded-full overflow-hidden border-4 border-[#E50914] shadow-[0_0_20px_rgba(229,9,20,0.5)] mb-4">
                    <img id="prof-img-display" src="" class="w-full h-full object-cover">
                </div>
                <h2 id="prof-name-display" class="text-xl font-bold text-white leading-tight">Nama Guru</h2>
                <p id="prof-nip-display" class="text-sm text-gray-400 mb-6">NIP. 12345</p>
                <button onclick="toggleEditProfile()" id="btn-toggle-edit" class="bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-full text-xs font-bold transition flex items-center gap-2 border border-gray-700">
                    <i class="fas fa-pencil-alt"></i> EDIT PROFIL
                </button>
            </div>
            <div class="w-full md:w-2/3 p-8 relative flex flex-col">
                <div class="flex justify-between items-start mb-6 border-b border-gray-800 pb-4">
                    <h3 class="text-xl font-bold text-[#E50914]">Informasi Guru</h3>
                    <button onclick="closeModal('profile-modal')" class="btn-back px-4 py-1.5 rounded-full text-xs font-bold text-white flex items-center gap-2">
                        <i class="fas fa-home"></i> Kembali
                    </button>
                </div>
                <div id="profile-view-mode" class="flex-grow flex flex-col space-y-4">
                    <div><label class="text-xs text-gray-500 uppercase font-bold">Jenis Kelamin</label><p id="prof-jk-display" class="text-lg text-white font-medium">-</p></div>
                    <div><label class="text-xs text-gray-500 uppercase font-bold">Mata Pelajaran</label><p id="prof-mapel-display" class="text-lg text-white font-medium">-</p></div>
                    <div><label class="text-xs text-gray-500 uppercase font-bold">WhatsApp</label><p id="prof-wa-display" class="text-lg text-white font-medium">-</p></div>
                    <div><label class="text-xs text-gray-500 uppercase font-bold">Alamat</label><p id="prof-alamat-display" class="text-white text-sm">-</p></div>
                </div>
                <form id="profile-edit-mode" onsubmit="handleUpdateProfile(event)" class="hidden space-y-3 h-full overflow-y-auto">
                    <input type="text" id="edit-username" class="hidden">
                    <div class="grid grid-cols-2 gap-3">
                        <div><label class="text-[10px] text-gray-400">Nama Lengkap</label><input type="text" id="edit-nama" class="w-full bg-[#222] border border-gray-700 p-2 rounded text-sm text-white focus:border-[#E50914] outline-none"></div>
                        <div><label class="text-[10px] text-gray-400">NIP</label><input type="text" id="edit-nip" class="w-full bg-[#222] border border-gray-700 p-2 rounded text-sm text-white focus:border-[#E50914] outline-none"></div>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div><label class="text-[10px] text-gray-400">Jenis Kelamin</label><select id="edit-jk" class="w-full bg-[#222] border border-gray-700 p-2 rounded text-sm text-white focus:border-[#E50914] outline-none"><option value="L">Laki-Laki</option><option value="P">Perempuan</option></select></div>
                        <div><label class="text-[10px] text-gray-400">Mapel</label><input type="text" id="edit-mapel" class="w-full bg-[#222] border border-gray-700 p-2 rounded text-sm text-white focus:border-[#E50914] outline-none"></div>
                    </div>
                    <div><label class="text-[10px] text-gray-400">No. WA</label><input type="text" id="edit-wa" class="w-full bg-[#222] border border-gray-700 p-2 rounded text-sm text-white focus:border-[#E50914] outline-none"></div>
                    <div><label class="text-[10px] text-gray-400">Link Foto</label><input type="text" id="edit-foto" class="w-full bg-[#222] border border-gray-700 p-2 rounded text-sm text-white focus:border-[#E50914] outline-none"></div>
                    <div><label class="text-[10px] text-gray-400">Alamat</label><textarea id="edit-alamat" rows="2" class="w-full bg-[#222] border border-gray-700 p-2 rounded text-sm text-white focus:border-[#E50914] outline-none"></textarea></div>
                    <div class="flex gap-2 pt-2"><button type="button" onclick="toggleEditProfile()" class="flex-1 bg-gray-700 text-xs py-2 rounded hover:bg-gray-600">Batal</button><button type="submit" id="btn-save-profile" class="flex-1 bg-[#E50914] text-xs py-2 rounded font-bold hover:bg-red-700">Simpan</button></div>
                </form>
            </div>
        </div>
    </div>

    <!-- 2. MODAL APLIKASI (UPDATED: Added Description) -->
    <div id="app-modal" class="fixed inset-0 z-[60] bg-black/90 hidden flex items-center justify-center p-4 backdrop-blur-md">
        <div class="glass-panel w-full max-w-4xl h-[80vh] rounded-2xl flex flex-col relative">
            <div class="p-6 border-b border-gray-800 flex justify-between items-center bg-[#111]">
                <div class="flex items-center gap-3">
                    <i class="fas fa-th-large text-blue-500 text-2xl"></i>
                    <div>
                        <h2 class="text-xl font-bold">Menu Aplikasi</h2>
                        <p class="text-xs text-gray-400">Akses Cepat Layanan BK</p>
                    </div>
                </div>
                <button onclick="closeModal('app-modal')" class="btn-back px-4 py-2 rounded-full text-sm font-bold text-white flex items-center gap-2">
                    <i class="fas fa-home"></i> Kembali
                </button>
            </div>
            <div class="flex-grow p-6 overflow-y-auto bg-black/40">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="app-grid-content">
                    <!-- Apps Injected Here -->
                </div>
            </div>
        </div>
    </div>

    <!-- 3. MODAL DATA SISWA (UPDATED: Print & Visual Bar) -->
    <div id="siswa-modal" class="fixed inset-0 z-[60] bg-black/90 hidden flex items-center justify-center p-4 backdrop-blur-md">
        <div class="glass-panel w-full max-w-6xl h-[90vh] rounded-2xl flex flex-col relative">
            <div class="p-5 border-b border-gray-800 flex justify-between items-center bg-[#111]">
                <div class="flex items-center gap-3"><div class="bg-green-900/30 p-2 rounded-lg text-green-500 border border-green-900"><i class="fas fa-user-graduate text-xl"></i></div><div><h2 class="text-xl font-bold">Database Siswa</h2><p class="text-xs text-gray-400">Kelola Data Peserta Didik</p></div></div>
                <div class="flex gap-2">
                    <!-- TOMBOL CETAK BARU -->
                    <button onclick="printSiswa()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-full text-sm font-bold text-white flex items-center gap-2 shadow-lg"><i class="fas fa-print"></i> Cetak</button>
                    <button onclick="closeModal('siswa-modal')" class="btn-back px-4 py-2 rounded-full text-sm font-bold text-white flex items-center gap-2"><i class="fas fa-home"></i> Kembali Dashboard</button>
                </div>
            </div>
            
            <!-- STATS BAR SISWA (ENHANCED WITH VISUAL BAR) -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-2 md:gap-4 px-4 pt-4 bg-[#1a1a1a]">
                <div class="bg-blue-900/20 p-3 rounded-lg border border-blue-900/50 text-center flex flex-col justify-center">
                    <h4 class="text-[10px] md:text-xs text-blue-400 uppercase font-bold tracking-widest">Total Siswa</h4>
                    <p id="count-total" class="text-2xl font-bold text-white">0</p>
                </div>
                <div class="bg-green-900/20 p-3 rounded-lg border border-green-900/50 text-center flex flex-col justify-center">
                    <h4 class="text-[10px] md:text-xs text-green-400 uppercase font-bold tracking-widest">Laki-Laki</h4>
                    <p id="count-l" class="text-2xl font-bold text-white">0</p>
                </div>
                <div class="bg-pink-900/20 p-3 rounded-lg border border-pink-900/50 text-center flex flex-col justify-center">
                    <h4 class="text-[10px] md:text-xs text-pink-400 uppercase font-bold tracking-widest">Perempuan</h4>
                    <p id="count-p" class="text-2xl font-bold text-white">0</p>
                </div>
                <!-- Visual Ratio Bar -->
                <div class="bg-gray-800 p-3 rounded-lg border border-gray-700 flex flex-col justify-center items-center">
                    <h4 class="text-[10px] text-gray-400 uppercase font-bold mb-2">Rasio L/P</h4>
                    <div class="w-full h-3 bg-pink-600 rounded-full overflow-hidden flex">
                        <div id="ratio-bar-l" class="h-full bg-green-500" style="width: 50%"></div>
                    </div>
                    <div class="flex justify-between w-full text-[10px] mt-1 text-gray-400">
                        <span id="ratio-text-l">L: 50%</span>
                        <span id="ratio-text-p">P: 50%</span>
                    </div>
                </div>
            </div>

            <div class="p-4 bg-[#1a1a1a] border-b border-gray-800 flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="relative w-full md:w-1/3"><i class="fas fa-search absolute left-3 top-3 text-gray-500"></i><input type="text" id="search-siswa" onkeyup="filterSiswa()" placeholder="Cari Nama atau NISN..." class="w-full bg-[#222] text-white pl-10 pr-4 py-2 rounded border border-gray-700 focus:border-green-500 focus:outline-none"></div>
                <div class="flex gap-2 w-full md:w-auto"><select id="filter-kelas" onchange="filterSiswa()" class="bg-[#222] text-white text-sm border border-gray-700 rounded p-2 px-4 focus:border-green-500 outline-none"><option value="all">Semua Kelas</option></select><select id="items-per-page" onchange="filterSiswa()" class="bg-[#222] text-white text-sm border border-gray-700 rounded p-2 px-4 focus:border-green-500 outline-none"><option value="5">5 Baris</option><option value="15">15 Baris</option><option value="30" selected>30 Baris</option><option value="50">50 Baris</option><option value="all">Semua Data</option></select></div>
            </div>
            <div class="flex-grow overflow-auto p-0 bg-black/20">
                <table class="w-full text-left text-sm text-gray-300" id="print-table-area">
                    <thead class="bg-[#111] text-xs uppercase text-gray-400 sticky top-0 z-10 shadow-lg">
                        <tr><th class="px-6 py-4 font-bold text-white">NISN</th><th class="px-6 py-4 font-bold text-white">Nama Siswa</th><th class="px-6 py-4 font-bold text-white">Kelas</th><th class="px-6 py-4 font-bold text-white">L/P</th><th class="px-6 py-4 font-bold text-white">No. WA</th><th class="px-6 py-4 font-bold text-white">Alamat</th></tr>
                    </thead>
                    <tbody id="siswa-table-body" class="divide-y divide-gray-800"></tbody>
                </table>
                <div id="siswa-empty" class="hidden flex flex-col items-center justify-center h-64 text-gray-500"><i class="fas fa-search-minus text-5xl mb-4 text-gray-700"></i><p class="text-lg">Data tidak ditemukan</p></div>
            </div>
            <div class="p-4 border-t border-gray-800 flex justify-between items-center bg-[#111]"><span id="page-info" class="text-xs text-gray-400">Menampilkan data...</span><div class="flex gap-2"><button onclick="changePage(-1)" class="px-4 py-1.5 bg-gray-800 hover:bg-gray-700 rounded text-xs text-white disabled:opacity-30 disabled:cursor-not-allowed transition" id="btn-prev">Prev</button><button onclick="changePage(1)" class="px-4 py-1.5 bg-gray-800 hover:bg-gray-700 rounded text-xs text-white disabled:opacity-30 disabled:cursor-not-allowed transition" id="btn-next">Next</button></div></div>
        </div>
    </div>

    <!-- 4. MODAL MEDIA -->
    <div id="media-list-modal" class="fixed inset-0 z-[60] bg-black/90 hidden flex items-center justify-center p-4 backdrop-blur-md">
        <div class="glass-panel w-full max-w-4xl h-[80vh] rounded-2xl flex flex-col relative">
            <div class="p-6 border-b border-gray-800 flex justify-between items-center bg-[#111]">
                <div class="flex items-center gap-3"><i class="fas fa-folder-open text-purple-500 text-2xl"></i><div><h2 class="text-xl font-bold">Media & RPLBK</h2><p class="text-xs text-gray-400">Arsip Digital Guru</p></div></div>
                <div class="flex gap-3"><button onclick="openMediaForm()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-full text-xs font-bold flex items-center gap-2 shadow-lg shadow-purple-900/50"><i class="fas fa-plus"></i> Upload</button><button onclick="closeModal('media-list-modal')" class="btn-back px-4 py-2 rounded-full text-xs font-bold text-white flex items-center gap-2"><i class="fas fa-home"></i> Kembali</button></div>
            </div>
            <div class="flex-grow p-6 overflow-y-auto bg-black/40"><div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="media-grid-content"></div></div>
        </div>
    </div>

    <!-- MODAL FORM INPUT MEDIA -->
    <div id="media-form-modal" class="fixed inset-0 z-[70] bg-black/80 hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-[#181818] rounded-xl w-full max-w-md p-6 border border-gray-700 shadow-2xl relative">
            <h3 class="text-xl font-bold mb-4 text-purple-500 flex items-center gap-2"><i class="fas fa-cloud-upload-alt"></i> Form Media</h3>
            <form onsubmit="handleSaveMedia(event)" class="space-y-4">
                <input type="hidden" id="media-id">
                <div><input type="text" id="media-nama" placeholder="Judul File / Dokumen" class="w-full bg-[#222] border border-gray-600 p-3 rounded-lg text-white text-sm focus:border-purple-500 outline-none" required></div>
                <div><textarea id="media-deskripsi" placeholder="Deskripsi Singkat" class="w-full bg-[#222] border border-gray-600 p-3 rounded-lg text-white text-sm focus:border-purple-500 outline-none" rows="2"></textarea></div>
                <div><input type="url" id="media-link" placeholder="Link File (Google Drive / PDF)" class="w-full bg-[#222] border border-gray-600 p-3 rounded-lg text-white text-sm focus:border-purple-500 outline-none" required></div>
                <div><input type="url" id="media-logo" placeholder="Link Gambar Cover (Opsional)" class="w-full bg-[#222] border border-gray-600 p-3 rounded-lg text-white text-sm focus:border-purple-500 outline-none"></div>
                <div class="flex justify-end gap-2 mt-6"><button type="button" onclick="document.getElementById('media-form-modal').classList.add('hidden')" class="px-4 py-2 text-sm text-gray-400 hover:text-white">Batal</button><button type="submit" id="btn-save-media" class="px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-sm font-bold shadow-lg">Simpan</button></div>
            </form>
        </div>
    </div>

    <!-- MODAL EMBED -->
    <div id="embed-modal" class="fixed inset-0 z-[80] bg-black hidden flex flex-col">
        <div class="bg-black/90 p-3 flex justify-between items-center border-b border-[#333]">
            <h3 id="embed-title" class="font-bold text-gray-200 ml-4 text-lg">App View</h3>
            <button onclick="document.getElementById('embed-modal').classList.add('hidden'); document.getElementById('embed-frame').src='';" class="btn-back px-4 py-1 rounded-full text-xs font-bold text-white flex items-center gap-2 mr-4"><i class="fas fa-home"></i> Tutup & Kembali</button>
        </div>
        <div class="flex-grow bg-[#141414] relative">
            <iframe id="embed-frame" src="" class="w-full h-full border-none"></iframe>
            <div id="embed-loader" class="absolute inset-0 flex items-center justify-center bg-[#141414] text-white flex-col gap-3">
                <div class="animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-red-600"></div><span class="text-sm text-gray-400">Memuat Aplikasi...</span>
            </div>
        </div>
    </div>

    <script>
        // CONFIG
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz2W3Wo4HiN9LiL8ghmEQDECjXkjOo74O0M8H3R7jElLy27hpCiFzIIj52j6XvnlBQt1w/exec"; 

        // STATE
        let currentUser = JSON.parse(localStorage.getItem('sobat_user')) || null;
        let appData = { apps: [], media: [], videos: [], siswa: [] };
        
        // PAGINATION STATE
        let siswaPage = 1;
        let siswaPerPage = 30;
        let filteredSiswa = [];

        // QUOTES DATA
        const quotes = [
            "Pendidikan adalah senjata paling mematikan di dunia.",
            "Guru yang baik itu ibarat lilin, membakar dirinya sendiri untuk menerangi orang lain.",
            "Siswa tidak butuh guru yang sempurna, mereka butuh guru yang bahagia.",
            "Tugas guru bukan menjejalkan pelajaran, melainkan menghidupkan pengetahuan.",
            "Setiap anak adalah juara, tugas kitalah menemukan pialanya."
        ];

        // INIT
        document.addEventListener('DOMContentLoaded', () => {
            // Cek Tema
            if(localStorage.getItem('sobat_theme') === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('theme-btn').innerHTML = '<i class="fas fa-moon text-lg"></i>';
            }

            // Set Random Quote
            document.getElementById('daily-quote').innerText = quotes[Math.floor(Math.random() * quotes.length)];

            if (currentUser) {
                initDashboard();
            } else {
                document.getElementById('login-screen').classList.remove('hidden');
            }
        });

        // ================= THEME LOGIC =================
        function toggleTheme() {
            const body = document.body;
            const btn = document.getElementById('theme-btn');
            
            body.classList.toggle('light-mode');
            
            if(body.classList.contains('light-mode')) {
                localStorage.setItem('sobat_theme', 'light');
                btn.innerHTML = '<i class="fas fa-moon text-lg"></i>';
            } else {
                localStorage.setItem('sobat_theme', 'dark');
                btn.innerHTML = '<i class="fas fa-sun text-lg"></i>';
            }
        }

        // ================= CUSTOM ALERT SYSTEM =================
        function showAlert(title, message, type = 'success') {
            const modal = document.getElementById('custom-alert-modal');
            const icon = document.getElementById('alert-icon');
            const iconBg = document.getElementById('alert-icon-bg');
            const titleEl = document.getElementById('alert-title');
            const msgEl = document.getElementById('alert-message');
            const btnContainer = document.getElementById('alert-buttons');

            titleEl.innerText = title;
            msgEl.innerText = message;

            // Reset styles
            iconBg.className = 'mx-auto flex items-center justify-center h-16 w-16 rounded-full mb-4 shadow-lg transform transition-all';
            
            if (type === 'success') {
                icon.className = 'fas fa-check text-3xl text-white';
                iconBg.classList.add('bg-green-600', 'shadow-green-500/50');
            } else if (type === 'error') {
                icon.className = 'fas fa-times text-3xl text-white';
                iconBg.classList.add('bg-red-600', 'shadow-red-500/50');
            } else {
                icon.className = 'fas fa-info text-3xl text-white';
                iconBg.classList.add('bg-blue-600', 'shadow-blue-500/50');
            }

            btnContainer.innerHTML = `
                <button onclick="document.getElementById('custom-alert-modal').classList.add('hidden')" class="bg-gray-700 hover:bg-gray-600 text-white px-8 py-2 rounded-full font-bold transition w-full">Tutup</button>
            `;

            modal.classList.remove('hidden');
        }

        function showConfirmCustom(title, message, onConfirm) {
            const modal = document.getElementById('custom-alert-modal');
            const icon = document.getElementById('alert-icon');
            const iconBg = document.getElementById('alert-icon-bg');
            const titleEl = document.getElementById('alert-title');
            const msgEl = document.getElementById('alert-message');
            const btnContainer = document.getElementById('alert-buttons');

            titleEl.innerText = title;
            msgEl.innerText = message;
            
            icon.className = 'fas fa-question text-3xl text-white';
            iconBg.className = 'mx-auto flex items-center justify-center h-16 w-16 rounded-full mb-4 shadow-lg bg-[#E50914] shadow-red-500/50';

            btnContainer.innerHTML = '';
            
            const btnCancel = document.createElement('button');
            btnCancel.className = 'bg-gray-700 hover:bg-gray-600 text-white px-6 py-2 rounded-full font-bold transition flex-1';
            btnCancel.innerText = 'Batal';
            btnCancel.onclick = () => modal.classList.add('hidden');

            const btnYes = document.createElement('button');
            btnYes.className = 'bg-[#E50914] hover:bg-red-700 text-white px-6 py-2 rounded-full font-bold transition flex-1';
            btnYes.innerText = 'Ya, Lanjutkan';
            btnYes.onclick = () => {
                modal.classList.add('hidden');
                onConfirm();
            };

            btnContainer.appendChild(btnCancel);
            btnContainer.appendChild(btnYes);

            modal.classList.remove('hidden');
        }

        // ================= AUTH LOGIC =================
        async function handleLogin(e) {
            e.preventDefault();
            const btn = document.getElementById('btn-login');
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;

            btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Memverifikasi...';
            btn.disabled = true;

            try {
                const res = await fetch(`${SCRIPT_URL}?action=login&username=${u}&password=${p}`);
                const json = await res.json();

                if (json.status === 'success') {
                    currentUser = json.data;
                    localStorage.setItem('sobat_user', JSON.stringify(currentUser));
                    initDashboard();
                    speakWelcome(currentUser.nama_guru); // VOICE GREETING
                } else {
                    showAlert('Gagal Masuk', json.message, 'error');
                }
            } catch (err) {
                showAlert('Koneksi Error', 'Pastikan internet terhubung dengan baik.', 'error');
            } finally {
                btn.innerHTML = 'MASUK APLIKASI <i class="fas fa-arrow-right"></i>';
                btn.disabled = false;
            }
        }

        function speakWelcome(name) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(`Selamat bekerja, ${name}. Semangat!`);
                utterance.lang = 'id-ID';
                window.speechSynthesis.speak(utterance);
            }
        }

        function confirmLogout() {
            showConfirmCustom('Konfirmasi Keluar', 'Apakah Anda yakin ingin keluar dari SOBAT-BK16?', () => {
                localStorage.removeItem('sobat_user');
                location.reload();
            });
        }

        async function initDashboard() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            
            document.getElementById('dash-nama').innerText = currentUser.nama_guru;
            if(currentUser.link_foto) document.getElementById('menu-foto').src = currentUser.link_foto;
            else document.getElementById('menu-foto').src = "https://ui-avatars.com/api/?name=" + currentUser.nama_guru;

            // Start Clock Immediately
            startClock();

            try {
                const res = await fetch(`${SCRIPT_URL}?action=get_all_data`);
                const json = await res.json();
                if (json.status === 'success') {
                    appData = json.data;
                    renderVideoSlider();
                    
                    // Update Stats
                    document.getElementById('stat-total-siswa').innerText = appData.siswa.length;
                    document.getElementById('stat-total-media').innerText = appData.media.length;
                }
            } catch (err) {
                console.error(err);
            }
        }

        // ================= WIDGET LOGIC (CLOCK) =================
        function startClock() {
            function update() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
                const dateString = now.toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                
                const timeEl = document.getElementById('widget-time');
                const dateEl = document.getElementById('widget-date');
                
                if(timeEl) timeEl.innerText = timeString;
                if(dateEl) dateEl.innerText = dateString;
            }
            update();
            setInterval(update, 1000);
        }

        // ================= MAGIC FAB LOGIC =================
        function toggleFab() {
            document.getElementById('fab-menu').classList.toggle('active');
            const icon = document.getElementById('fab-icon-main');
            if(document.getElementById('fab-menu').classList.contains('active')){
                icon.style.transform = 'rotate(45deg)';
            } else {
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // --- STOPWATCH ---
        let swInterval;
        let swSeconds = 0;
        let swIsRunning = false;

        function openStopwatchModal() {
            document.getElementById('stopwatch-modal').classList.remove('hidden');
            toggleFab();
        }

        function updateStopwatch() {
            swSeconds++;
            const hrs = Math.floor(swSeconds / 3600);
            const mins = Math.floor((swSeconds % 3600) / 60);
            const secs = swSeconds % 60;
            document.getElementById('sw-display').innerText = 
                `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function startStopwatch() {
            if (!swIsRunning) {
                swInterval = setInterval(updateStopwatch, 1000);
                swIsRunning = true;
                document.getElementById('sw-start').disabled = true;
                document.getElementById('sw-start').classList.add('opacity-50');
            }
        }

        function pauseStopwatch() {
            clearInterval(swInterval);
            swIsRunning = false;
            document.getElementById('sw-start').disabled = false;
            document.getElementById('sw-start').classList.remove('opacity-50');
        }

        function resetStopwatch() {
            pauseStopwatch();
            swSeconds = 0;
            document.getElementById('sw-display').innerText = "00:00:00";
        }

        // --- NOTES (LOCAL STORAGE) ---
        function openNoteModal() {
            const savedNote = localStorage.getItem('sobat_notes') || '';
            document.getElementById('my-notes').value = savedNote;
            document.getElementById('note-modal').classList.remove('hidden');
            toggleFab();
        }

        function saveNotes() {
            const text = document.getElementById('my-notes').value;
            localStorage.setItem('sobat_notes', text);
            showAlert('Tersimpan', 'Catatan berhasil disimpan di perangkat ini.', 'success');
            setTimeout(() => document.getElementById('note-modal').classList.add('hidden'), 1000);
        }

        // --- EXPORT TO CSV ---
        function exportSiswaToCSV() {
            if (!appData.siswa || appData.siswa.length === 0) {
                showAlert('Info', 'Tidak ada data siswa untuk diexport.', 'info');
                return;
            }
            
            // Header
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "NISN,Nama Siswa,Kelas,L/P,No WA,Alamat\n";
            
            // Rows
            appData.siswa.forEach(function(row) {
                let rowStr = `${row.nisn},"${row.nama_siswa}",${row.kelas},${row.jk},${row.no_wa || '-'},"${row.alamat}"`;
                csvContent += rowStr + "\n";
            });
            
            // Download Trigger
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "Data_Siswa_SOBAT_BK.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            toggleFab();
            showAlert('Download Mulai', 'File Excel (CSV) sedang didownload.', 'success');
        }

        // ================= FEATURE: PROFIL =================
        function openProfileModal() {
            const u = currentUser;
            const imgUrl = u.link_foto || `https://ui-avatars.com/api/?name=${u.nama_guru}`;
            
            document.getElementById('prof-img-display').src = imgUrl;
            document.getElementById('prof-name-display').innerText = u.nama_guru;
            document.getElementById('prof-nip-display').innerText = `NIP. ${u.nip}`;
            
            document.getElementById('prof-jk-display').innerText = u.jk || '-';
            document.getElementById('prof-mapel-display').innerText = u.mapel;
            document.getElementById('prof-wa-display').innerText = u.no_wa;
            document.getElementById('prof-alamat-display').innerText = u.alamat;

            document.getElementById('edit-username').value = u.username;
            document.getElementById('edit-nama').value = u.nama_guru;
            document.getElementById('edit-nip').value = u.nip;
            document.getElementById('edit-jk').value = u.jk || 'L';
            document.getElementById('edit-mapel').value = u.mapel;
            document.getElementById('edit-wa').value = u.no_wa;
            document.getElementById('edit-foto').value = u.link_foto;
            document.getElementById('edit-alamat').value = u.alamat;

            document.getElementById('profile-view-mode').classList.remove('hidden');
            document.getElementById('profile-edit-mode').classList.add('hidden');
            document.getElementById('btn-toggle-edit').classList.remove('hidden');
            
            document.getElementById('profile-modal').classList.remove('hidden');
        }

        function toggleEditProfile() {
            const view = document.getElementById('profile-view-mode');
            const form = document.getElementById('profile-edit-mode');
            const btn = document.getElementById('btn-toggle-edit');

            if (view.classList.contains('hidden')) {
                view.classList.remove('hidden');
                form.classList.add('hidden');
                btn.classList.remove('hidden');
            } else {
                view.classList.add('hidden');
                form.classList.remove('hidden');
                btn.classList.add('hidden');
            }
        }

        async function handleUpdateProfile(e) {
            e.preventDefault();
            const btn = document.getElementById('btn-save-profile');
            btn.innerText = "Menyimpan...";
            
            const payload = {
                action: 'update_profile',
                username: document.getElementById('edit-username').value,
                nama_guru: document.getElementById('edit-nama').value,
                nip: document.getElementById('edit-nip').value,
                jk: document.getElementById('edit-jk').value,
                mapel: document.getElementById('edit-mapel').value,
                no_wa: document.getElementById('edit-wa').value,
                alamat: document.getElementById('edit-alamat').value,
                link_foto: document.getElementById('edit-foto').value
            };

            try {
                const res = await fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(payload) });
                const json = await res.json();

                if (json.status === 'success') {
                    Object.assign(currentUser, payload);
                    localStorage.setItem('sobat_user', JSON.stringify(currentUser));
                    showAlert('Sukses', 'Profil berhasil diperbarui!', 'success');
                    setTimeout(() => location.reload(), 1500);
                } else {
                    showAlert('Gagal', json.message, 'error');
                }
            } catch (err) { showAlert('Error', 'Terjadi kesalahan sistem', 'error'); }
            btn.innerText = "Simpan";
        }

        // ================= FEATURE: APLIKASI (GRID) =================
        function openAppModal() {
            const container = document.getElementById('app-grid-content');
            container.innerHTML = appData.apps.map(app => `
                <div onclick="openEmbed('${app.link_tuju}', '${app.nama_aplikasi}')" class="bg-[#1a1a1a] p-4 rounded-xl cursor-pointer hover:bg-[#252525] border border-gray-800 hover:border-blue-500 transition group flex flex-col items-center text-center shadow-lg">
                    <div class="overflow-hidden rounded-lg w-20 h-20 mb-3 bg-gray-800">
                        <img src="${app.link_logo || 'https://via.placeholder.com/100?text=App'}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                    </div>
                    <h4 class="font-bold text-sm text-white group-hover:text-blue-400">${app.nama_aplikasi}</h4>
                    <p class="text-[10px] text-gray-400 mt-2 line-clamp-2 px-2">${app.deskripsi || 'Tidak ada deskripsi'}</p>
                    <span class="text-[10px] text-blue-500 mt-2 font-bold uppercase tracking-wide">Buka Aplikasi</span>
                </div>
            `).join('');
            document.getElementById('app-modal').classList.remove('hidden');
        }

        // ================= FEATURE: SISWA (PAGINATION & SEARCH & PRINT) =================
        function openSiswaModal() {
            const classes = [...new Set(appData.siswa.map(s => s.kelas))].sort();
            const select = document.getElementById('filter-kelas');
            select.innerHTML = '<option value="all">Semua Kelas</option>' + 
                classes.map(c => `<option value="${c}">${c}</option>`).join('');
            
            filterSiswa();
            document.getElementById('siswa-modal').classList.remove('hidden');
        }

        function filterSiswa() {
            const cls = document.getElementById('filter-kelas').value;
            const searchVal = document.getElementById('search-siswa').value.toLowerCase();
            const perPageVal = document.getElementById('items-per-page').value;

            // 1. FILTERING
            filteredSiswa = appData.siswa.filter(s => {
                const matchClass = cls === 'all' || s.kelas === cls;
                const matchSearch = s.nama_siswa.toLowerCase().includes(searchVal) || 
                                    (s.nisn && s.nisn.toString().includes(searchVal));
                return matchClass && matchSearch;
            });

            // 2. CALCULATE STATS (REAL-TIME) & VISUAL BAR
            const total = filteredSiswa.length;
            const l = filteredSiswa.filter(s => s.jk === 'L').length;
            const p = filteredSiswa.filter(s => s.jk === 'P').length;

            document.getElementById('count-total').innerText = total;
            document.getElementById('count-l').innerText = l;
            document.getElementById('count-p').innerText = p;
            
            // Visual Bar Logic
            let percentL = total > 0 ? (l / total) * 100 : 0;
            let percentP = total > 0 ? (p / total) * 100 : 0;
            document.getElementById('ratio-bar-l').style.width = `${percentL}%`;
            document.getElementById('ratio-text-l').innerText = `L: ${Math.round(percentL)}%`;
            document.getElementById('ratio-text-p').innerText = `P: ${Math.round(percentP)}%`;
            
            // 3. PAGINATION SETUP
            if (perPageVal === 'all') {
                siswaPerPage = filteredSiswa.length || 1;
            } else {
                siswaPerPage = parseInt(perPageVal);
            }
            
            siswaPage = 1;
            renderSiswaTable();
        }

        function changePage(delta) {
            const maxPage = Math.ceil(filteredSiswa.length / siswaPerPage);
            const newPage = siswaPage + delta;
            if (newPage >= 1 && newPage <= maxPage) {
                siswaPage = newPage;
                renderSiswaTable();
            }
        }

        function renderSiswaTable() {
            const start = (siswaPage - 1) * siswaPerPage;
            const end = start + siswaPerPage;
            const pageData = filteredSiswa.slice(start, end);
            
            const tbody = document.getElementById('siswa-table-body');
            const empty = document.getElementById('siswa-empty');
            
            if (pageData.length === 0) {
                tbody.innerHTML = '';
                empty.classList.remove('hidden');
            } else {
                empty.classList.add('hidden');
                tbody.innerHTML = pageData.map(s => `
                    <tr class="hover:bg-[#252525] transition border-b border-gray-800">
                        <td class="px-6 py-3 font-medium text-white font-mono text-xs">${s.nisn}</td>
                        <td class="px-6 py-3 flex items-center gap-3">
                            <img src="https://ui-avatars.com/api/?name=${s.nama_siswa}&background=random" class="w-8 h-8 rounded-full border border-gray-600">
                            <span class="font-semibold text-gray-200">${s.nama_siswa}</span>
                        </td>
                        <td class="px-6 py-3"><span class="bg-blue-900/30 text-blue-400 px-2 py-1 rounded text-xs font-bold border border-blue-900">${s.kelas}</span></td>
                        <td class="px-6 py-3 text-xs">${s.jk}</td>
                        <td class="px-6 py-3 text-xs font-mono">${s.no_wa || '-'}</td>
                        <td class="px-6 py-3 text-xs text-gray-400 truncate max-w-xs">${s.alamat}</td>
                    </tr>
                `).join('');
            }

            const maxPage = Math.ceil(filteredSiswa.length / siswaPerPage) || 1;
            const startInfo = filteredSiswa.length === 0 ? 0 : start + 1;
            const endInfo = Math.min(end, filteredSiswa.length);
            
            document.getElementById('page-info').innerText = `Menampilkan ${startInfo}-${endInfo} dari ${filteredSiswa.length} Data (Hal ${siswaPage}/${maxPage})`;
            
            document.getElementById('btn-prev').disabled = siswaPage === 1;
            document.getElementById('btn-next').disabled = siswaPage === maxPage;
        }

        // PRINT FUNCTION (NEW)
        function printSiswa() {
            if (filteredSiswa.length === 0) {
                showAlert('Info', 'Tidak ada data siswa untuk dicetak.', 'info');
                return;
            }

            const printWindow = window.open('', '', 'width=800,height=600');
            const dataToPrint = filteredSiswa; // Cetak semua data hasil filter, bukan cuma halaman ini
            
            let html = `
                <html>
                <head>
                    <title>Laporan Data Siswa SOBAT-BK16</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { text-align: center; color: #333; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 12px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f2f2f2; color: #333; font-weight: bold; }
                        tr:nth-child(even) { background-color: #f9f9f9; }
                        .footer { margin-top: 20px; text-align: right; font-size: 10px; color: #555; }
                    </style>
                </head>
                <body>
                    <h1>Laporan Data Siswa</h1>
                    <p>Total Data: ${dataToPrint.length} | Filter Kelas: ${document.getElementById('filter-kelas').value.toUpperCase()}</p>
                    <table>
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>NISN</th>
                                <th>Nama Siswa</th>
                                <th>Kelas</th>
                                <th>L/P</th>
                                <th>No. WA</th>
                                <th>Alamat</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            dataToPrint.forEach((s, index) => {
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${s.nisn}</td>
                        <td>${s.nama_siswa}</td>
                        <td>${s.kelas}</td>
                        <td>${s.jk}</td>
                        <td>${s.no_wa || '-'}</td>
                        <td>${s.alamat}</td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                    <div class="footer">Dicetak dari SOBAT-BK16 pada ${new Date().toLocaleString('id-ID')}</div>
                </body>
                </html>
            `;

            printWindow.document.write(html);
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 500);
        }

        // ================= FEATURE: MEDIA (GRID & EDIT) =================
        function openMediaListModal() {
            renderMediaGrid();
            document.getElementById('media-list-modal').classList.remove('hidden');
        }

        function renderMediaGrid() {
            const container = document.getElementById('media-grid-content');
            container.innerHTML = appData.media.map(m => {
                const isOwner = m.uploaded_by == currentUser.username;
                return `
                <div class="bg-[#1a1a1a] rounded-xl overflow-hidden border border-gray-800 hover:border-purple-500 transition group relative shadow-md">
                    <img src="${m.link_logo || 'https://via.placeholder.com/150?text=DOC'}" class="w-full h-36 object-cover opacity-70 group-hover:opacity-100 transition">
                    <div class="p-4 relative bg-[#111]">
                        <h4 class="font-bold text-sm text-white truncate">${m.nama_media}</h4>
                        <p class="text-xs text-gray-500 truncate mt-1">${m.deskripsi}</p>
                    </div>
                    
                    <div class="absolute inset-0 bg-black/80 flex items-center justify-center gap-3 opacity-0 group-hover:opacity-100 transition backdrop-blur-sm">
                        <a href="${m.link_file}" target="_blank" class="bg-white text-black w-10 h-10 rounded-full flex items-center justify-center hover:bg-gray-200 transition transform hover:scale-110" title="Lihat"><i class="fas fa-eye"></i></a>
                        ${isOwner ? `
                        <button onclick='editMedia(${JSON.stringify(m)})' class="bg-purple-600 text-white w-10 h-10 rounded-full flex items-center justify-center hover:bg-purple-500 transition transform hover:scale-110" title="Edit"><i class="fas fa-pencil-alt"></i></button>
                        ` : ''}
                    </div>
                </div>
            `}).join('');
        }

        function openMediaForm() {
            document.getElementById('media-id').value = '';
            document.getElementById('media-nama').value = '';
            document.getElementById('media-deskripsi').value = '';
            document.getElementById('media-link').value = '';
            document.getElementById('media-logo').value = '';
            document.getElementById('media-form-modal').classList.remove('hidden');
        }

        function editMedia(m) {
            document.getElementById('media-id').value = m.id_media;
            document.getElementById('media-nama').value = m.nama_media;
            document.getElementById('media-deskripsi').value = m.deskripsi;
            document.getElementById('media-link').value = m.link_file;
            document.getElementById('media-logo').value = m.link_logo;
            document.getElementById('media-form-modal').classList.remove('hidden');
        }

        async function handleSaveMedia(e) {
            e.preventDefault();
            const btn = document.getElementById('btn-save-media');
            btn.innerText = "Processing...";

            const payload = {
                action: 'save_media',
                current_user: currentUser.username,
                id_media: document.getElementById('media-id').value,
                nama_media: document.getElementById('media-nama').value,
                deskripsi: document.getElementById('media-deskripsi').value,
                link_file: document.getElementById('media-link').value,
                link_logo: document.getElementById('media-logo').value
            };

            try {
                const res = await fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(payload) });
                const json = await res.json();
                if (json.status === 'success') {
                    showAlert('Sukses', 'Media berhasil disimpan!', 'success');
                    setTimeout(() => location.reload(), 1500);
                } else {
                    showAlert('Error', json.message, 'error');
                }
            } catch (err) { showAlert('Gagal', 'Terjadi kesalahan sistem', 'error'); }
            btn.innerText = "Simpan";
        }

        // ================= FEATURE: VIDEO (SLIDER) =================
        function renderVideoSlider() {
            const container = document.getElementById('video-container');
            container.innerHTML = appData.videos.map(v => {
                const vidId = extractVideoID(v.link_video);
                
                if (!vidId) return ''; // Skip invalid

                return `
                <div class="flex-none w-80 bg-[#1a1a1a] rounded-xl overflow-hidden border border-gray-800 shadow-lg group flex flex-col">
                    <div class="relative w-full h-44 bg-black cursor-pointer group" onclick="playVideo(this, '${vidId}')">
                        <!-- Thumbnail -->
                        <img src="https://img.youtube.com/vi/${vidId}/hqdefault.jpg" 
                             onerror="this.src='https://via.placeholder.com/320x180?text=No+Thumbnail'" 
                             class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition duration-300">
                        <!-- Play Button Overlay -->
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="bg-red-600 text-white rounded-full w-12 h-12 flex items-center justify-center pl-1 shadow-lg transform group-hover:scale-110 transition">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                    </div>
                    <div class="p-4 flex-grow flex flex-col justify-between">
                        <div>
                            <h4 class="text-sm font-bold text-white mb-1 line-clamp-2" title="${v.judul}">${v.judul}</h4>
                            <p class="text-xs text-gray-400 line-clamp-2">${v.deskripsi || 'Video Pembelajaran'}</p>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function extractVideoID(url) {
            if (!url) return null;
            url = url.trim();
            try {
                // Coba bersihkan URL dari teks iframe jika ada
                if(url.includes('src="')) {
                    const srcMatch = url.match(/src="([^"]+)"/);
                    if(srcMatch) url = srcMatch[1];
                }
                
                const urlObj = new URL(url);
                
                // Case 1: youtu.be/ID
                if (urlObj.hostname.includes('youtu.be')) {
                    return urlObj.pathname.slice(1);
                }
                
                // Case 2: youtube.com/watch?v=ID
                if (urlObj.hostname.includes('youtube.com')) {
                    if (urlObj.searchParams.has('v')) {
                        return urlObj.searchParams.get('v');
                    }
                    // Case 3: youtube.com/embed/ID or /v/ID or /shorts/ID
                    const pathParts = urlObj.pathname.split('/');
                    // pathParts[0] is empty, [1] is 'embed', [2] is ID
                    if (pathParts.length > 2 && (pathParts[1] === 'embed' || pathParts[1] === 'v' || pathParts[1] === 'shorts')) {
                        return pathParts[2];
                    }
                }
                return null;
            } catch (e) {
                // Fallback Regex jika URL tidak valid (misal user hanya copy ID atau string parsial)
                const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
                const match = url.match(regExp);
                return (match && match[2].length === 11) ? match[2] : null;
            }
        }

        function playVideo(element, vidId) {
            // PENTING: mute=1 ditambahkan agar autoplay diizinkan oleh browser
            element.innerHTML = `<iframe src="https://www.youtube.com/embed/${vidId}?autoplay=1&mute=1&rel=0" class="w-full h-full border-none" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
            element.removeAttribute('onclick');
            element.classList.remove('cursor-pointer');
        }

        // UTILS
        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
        }
        function openEmbed(url, title) {
            document.getElementById('embed-title').innerText = title;
            document.getElementById('embed-modal').classList.remove('hidden');
            document.getElementById('embed-frame').src = url;
            document.getElementById('embed-loader').classList.remove('hidden');
            document.getElementById('embed-frame').onload = () => document.getElementById('embed-loader').classList.add('hidden');
        }
    </script>
</body>
</html>
